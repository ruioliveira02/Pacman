<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa1</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module which generates valid mazes as per the task statement.</p><p>A maze is considered valid if and only if it is at least of size 15x10,
    has a tunnel connecting the two ends of it in the middle row (or middle rows, if of
    even height), and has the ghost house placed in the middle of it.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:generateRandoms">generateRandoms</a> :: Int -&gt; Int -&gt; [Int]</li><li class="src short"><a href="#v:convertIntListToCorridor">convertIntListToCorridor</a> :: [Int] -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:generateWall">generateWall</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:getHouseLength">getHouseLength</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:generateArroundHouse">generateArroundHouse</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:generateInsideHouse">generateInsideHouse</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:generateUpperHouse">generateUpperHouse</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:generateBottomHouse">generateBottomHouse</a> :: Int -&gt; Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:generateStartingMaze">generateStartingMaze</a> :: Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:changeVal1D">changeVal1D</a> :: [a] -&gt; Int -&gt; a -&gt; [a]</li><li class="src short"><a href="#v:changeVal">changeVal</a> :: [[a]] -&gt; (Int, Int) -&gt; a -&gt; [[a]]</li><li class="src short"><a href="#v:get">get</a> :: [[a]] -&gt; (Int, Int) -&gt; a</li><li class="src short"><a href="#v:first">first</a> :: (a, b, c) -&gt; a</li><li class="src short"><a href="#v:selectSquare">selectSquare</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; (Int, Int) -&gt; (Int, Int) -&gt; [[Bool]] -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] -&gt; (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, [<a href="Types.html#t:Piece" title="Types">Piece</a>])</li><li class="src short"><a href="#v:truncate-39-">truncate'</a> :: (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>) -&gt; (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>)</li><li class="src short"><a href="#v:selectMove">selectMove</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; (Int, Int) -&gt; (Int, Int) -&gt; [[Bool]] -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] -&gt; ((Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>), [<a href="Types.html#t:Piece" title="Types">Piece</a>])</li><li class="src short"><a href="#v:dfs">dfs</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; (Int, Int) -&gt; (Int, Int) -&gt; [[Bool]] -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; (<a href="Types.html#t:Maze" title="Types">Maze</a>, [[Bool]], [<a href="Types.html#t:Piece" title="Types">Piece</a>])</li><li class="src short"><a href="#v:fixMaze">fixMaze</a> :: (Int, Int) -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:generateMaze">generateMaze</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:generateRandoms" class="def">generateRandoms</a> <a href="#v:generateRandoms" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The length of the wanted list</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>The given seed</p></td></tr><tr><td class="src">-&gt; [Int]</td><td class="doc"><p>The resulting list of numbers</p></td></tr></table></div><div class="doc"><p>Generates a list of n pseudo-randoms integers based on the given seed</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateRandoms 5 123
</code></strong>[43,5,7,30,50]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateRandoms 7 4124354
</code></strong>[89,72,69,7,20,33,49]
</pre></div></div><div class="top"><p class="src"><a id="v:convertIntListToCorridor" class="def">convertIntListToCorridor</a> <a href="#v:convertIntListToCorridor" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [Int]</td><td class="doc"><p>List of pseudo-random ints</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>Corresponding corridor</p></td></tr></table></div><div class="doc"><p>Given a list of pseudo-random integers, returns a <code><a href="Types.html#t:Corridor" title="Types">Corridor</a></code> 
  based on the probabilities of each type of Piece</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>convertIntListToCorridor [3,45,98,1,0,4]
</code></strong>[o,.,#,.,.,.]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>convertIntListToCorridor [56,9,12,9,75,90,34]
</code></strong>[.,.,.,.,#,#,.]
</pre></div></div><div class="top"><p class="src"><a id="v:generateWall" class="def">generateWall</a> <a href="#v:generateWall" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The length of the desired corridor</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>Resulting corridor</p></td></tr></table></div><div class="doc"><p>Returns a corridor of length len consisting of only <code><a href="Types.html#v:Wall" title="Types">Wall</a></code></p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateWall 5
</code></strong>[#,#,#,#,#]
</pre></div></div><div class="top"><p class="src"><a id="v:getHouseLength" class="def">getHouseLength</a> <a href="#v:getHouseLength" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>The width of the ghostHouse</p></td></tr></table></div><div class="doc"><p>Returns the length of the ghost house including walls (8 if length is even, 9 otherwise)</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>getHouseLength 20
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>8
</code></strong></pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>getHouseLength 31
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>9
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:generateArroundHouse" class="def">generateArroundHouse</a> <a href="#v:generateArroundHouse" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The original corridor</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The new corridor</p></td></tr></table></div><div class="doc"><p>Fixes the corridors directly above and below the house (see restrictions)</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateArroundHouse 20 (generateWall 20)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[#,#,#,#,#, , , , , , , , , , ,#,#,#,#,#]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:generateInsideHouse" class="def">generateInsideHouse</a> <a href="#v:generateInsideHouse" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The original corridor</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The new corridor</p></td></tr></table></div><div class="doc"><p>Fixes the <code><a href="Types.html#t:Corridor" title="Types">Corridor</a></code> that passes through the ghost house</p><p>It also makes sure that the tunnel is clear, i.e, that it is possible to reach the ghost
   house from the tunnel. It does this by replacing all walls from the generated maze with Empty</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateInsideHouse 20 (generateWall 20)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[ , , , , , ,#, , , , , , ,#, , , , , , ]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:generateUpperHouse" class="def">generateUpperHouse</a> <a href="#v:generateUpperHouse" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The original corridor</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The new corridor</p></td></tr></table></div><div class="doc"><p>Generates the <code><a href="Types.html#t:Corridor" title="Types">Corridor</a></code> containing the door to the ghost house</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateUpperHouse 20 (generateWall 20)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[#,#,#,#,#, ,#,#,#, , ,#,#,#, ,#,#,#,#,#]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:generateBottomHouse" class="def">generateBottomHouse</a> <a href="#v:generateBottomHouse" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>The height of the maze</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The original corridor</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></td><td class="doc"><p>The new corridor</p></td></tr></table></div><div class="doc"><p>Generates the <code><a href="Types.html#t:Corridor" title="Types">Corridor</a></code> containing the bottom of the ghost house.</p><p>Requires both width and height of the maze</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateBottomHouse 20 10 (generateWall 20)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[ ,#,#,#,#, ,#,#,#,#,#,#,#,#, ,#,#,#,#, ]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:generateStartingMaze" class="def">generateStartingMaze</a> <a href="#v:generateStartingMaze" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The width of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>The height of the maze</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The resulting maze</p></td></tr></table></div><div class="doc"><p>Generates a <code><a href="Types.html#t:Maze" title="Types">Maze</a></code> consisting of only walls</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateStartingMaze 5 2
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[[#,#,#,#,#], [#,#,#,#,#]]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:changeVal1D" class="def">changeVal1D</a> <a href="#v:changeVal1D" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [a]</td><td class="doc"><p>The original list</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Position of the element to change</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>The new element</p></td></tr><tr><td class="src">-&gt; [a]</td><td class="doc"><p>The resulting list</p></td></tr></table></div><div class="doc"><p>Given a list, returns the list obtained by replacing the x-th element (base 0) with the given element</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>changeVal1D [1,2,3] 1 0
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[1,0,3]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:changeVal" class="def">changeVal</a> <a href="#v:changeVal" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[a]]</td><td class="doc"><p>The original list of lists</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The coordinates (x,y) (base 0) of the value to replace</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>The new value</p></td></tr><tr><td class="src">-&gt; [[a]]</td><td class="doc"><p>The resulting list</p></td></tr></table></div><div class="doc"><p>Given a list of lists, returns the list obtained by replacing the element at position (x,y),
   i.e, the x-th element of the y-th list (indices base 0), with the given element</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>changeVal [[1,2], [3,4]] (1,1) 0
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[[1,2], [3,0]]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:get" class="def">get</a> <a href="#v:get" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [[a]]</td><td class="doc"><p>The list of lists</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The coordinates (x,y) (base 0) of the wanted element</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>The wanted element</p></td></tr></table></div><div class="doc"><p>Given a list of lists, returns the element at position (x,y),
   i.e, the x-th element of the y-th list (indices base 0)</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>get [[1,2], [3,4]] (1,1)
</code></strong>4
</pre></div></div><div class="top"><p class="src"><a id="v:first" class="def">first</a> <a href="#v:first" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (a, b, c)</td><td class="doc"><p>The given triple</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>The first element</p></td></tr></table></div><div class="doc"><p>Returns the first element of a triple</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>first (1,2,3)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>1
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:selectSquare" class="def">selectSquare</a> <a href="#v:selectSquare" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The given maze</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The coordinates of the given square</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The size of the maze (width, height)</p></td></tr><tr><td class="src">-&gt; [[Bool]]</td><td class="doc"><p>The list of visited squares</p></td></tr><tr><td class="src">-&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>]</td><td class="doc"><p>The list of pieces to choose from</p></td></tr><tr><td class="src">-&gt; (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, [<a href="Types.html#t:Piece" title="Types">Piece</a>])</td><td class="doc"><p>The resulting piece and leftover pieces</p></td></tr></table></div><div class="doc"><p>Given a <code><a href="Types.html#t:Maze" title="Types">Maze</a></code>, the coordinates of the current square, the size of the maze, the list of visited squares and the list of pieces to choose from, returns the piece to place on that square
   (if square out of bounds or already visited, returns <code>Nothing</code>, otherwise, 'Just Piece'), as well as the pieces with have not been used, so they can be selected in the future</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>used = take 20 (repeat (take 20 (repeat False)))
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>selectSquare (generateStartingMaze 20 20) (5,5) (20,20) used [Wall, Empty, Wall, Food Little]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>(Just #,[ ,#,.])
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:truncate-39-" class="def">truncate'</a> <a href="#v:truncate-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>)</td><td class="doc"><p>The original set of pieces</p></td></tr><tr><td class="src">-&gt; (Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>)</td><td class="doc"><p>The new set of pieces, containing at least one Food Little</p></td></tr></table></div><div class="doc"><p>Given a 4-uple of potential pieces, returns a valid 4-uple, i.e., returns a 4-uple in where at least one of the component is either a Food or Empty.</p><p>This makes sure that the DFS will continue until all squares have been visited and that it will not stop because it decided to surround itself in walls. </p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>truncate' (Nothing, Nothing, Nothing, Nothing) = (Nothing, Nothing, Nothing, Nothing)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>truncate' (Just Wall, Just Wall, Just Wall, Nothing) = (Just (Food Little), Just (Food Little), Just (Food Little), Nothing)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>truncate' (Just Wall, Just Wall, Just Wall, Just Wall) = (Just (Food Little), Just (Food Little), Just (Food Little), Just (Food Little))
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>truncate' (Just Empty, Just Empty, Just Empty, Just (Food Little)) = (Just Empty, Just Empty, Just Empty, Just (Food Little))
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:selectMove" class="def">selectMove</a> <a href="#v:selectMove" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The given maze</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The coordinates (x,y) of the square</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The size of the maze (width, height)</p></td></tr><tr><td class="src">-&gt; [[Bool]]</td><td class="doc"><p>The list of visited squares</p></td></tr><tr><td class="src">-&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>]</td><td class="doc"><p>The list of pieces to choose from</p></td></tr><tr><td class="src">-&gt; ((Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>, Maybe <a href="Types.html#t:Piece" title="Types">Piece</a>), [<a href="Types.html#t:Piece" title="Types">Piece</a>])</td><td class="doc"><p>The resulting moves (if not possible to move to neighbour, <code>Nothing</code>, otherwise, 'Just Piece') and leftover pieces</p></td></tr></table></div><div class="doc"><p>Given a maze, a position in said maze, a list of visited squares and a list of pieces to choose from, returns the pieces to replace all neighbours of the current square with</p><p>The choice for each component is done by the  <code><a href="Tarefa1.html#v:selectSquare" title="Tarefa1">selectSquare</a></code> function</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>used = take 20 (repeat (take 20 (repeat False)))
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>selectMove (generateStartingMaze 20 20) (3,3) (20,20) used [Wall, Empty, Wall, Food Little]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>((Just .,Just #,Just  ,Just #),[])
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:dfs" class="def">dfs</a> <a href="#v:dfs" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The starting maze (at first only containing walls)</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The coordinates (x,y) of the current square</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>The width and height of the maze</p></td></tr><tr><td class="src">-&gt; [[Bool]]</td><td class="doc"><p>The list of which squares have been visited (at first all values are False)</p></td></tr><tr><td class="src">-&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>]</td><td class="doc"><p>The list of pieces to choose from</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Piece" title="Types">Piece</a></td><td class="doc"><p>The piece to replace current square with</p></td></tr><tr><td class="src">-&gt; (<a href="Types.html#t:Maze" title="Types">Maze</a>, [[Bool]], [<a href="Types.html#t:Piece" title="Types">Piece</a>])</td><td class="doc"><p>The resulting maze, the list of used squares and the leftover pieces for future choices</p></td></tr></table></div><div class="doc"><p>Given a starting maze consisting of only walls, a list of pieces and a piece, constructs a maze where every square is reachable from any other square (excluding walls, for obvious reasons)</p><p>As the name implies, this function transverses the maze depth-first. When it reaches a square, if it has not been visited before and is within bounds, replace the wall with the value of the piece argument
   and mark it as visited. It then send the list of pieces to the <code><a href="Tarefa1.html#v:selectMove" title="Tarefa1">selectMove</a></code> function, which will select the pieces to place on the other neighbouring squares which haven't been visited yet.</p><p>After this, it visits each of the neighbouring squares and replaces their Wall with the selected piece</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>maze = generateStartingMaze 20 20
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>used = take 20 (repeat (take 20 (repeat False)))
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>pieces = convertIntListToCorridor (generateRandoms 600 123)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>dfs maze (1,1) (20,20) used pieces (Food Little)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>([[#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#],
</code></strong>      [#,.,.,.,#,.,.,.,.,#,#,#,.,.,.,.,.,#,.,#],
      [#,.,.,.,.,.,.,#,.,.,.,.,.,#,.,.,.,.,.,#],
      [#,.,.,#,.,.,.,.,.,.,.,.,.,.,.,#,#,.,.,#],
      [#,#,.,.,.,#,#,.,.,#,.,.,.,.,.,.,.,.,.,#],
      [#,.,#,#,.,.,.,.,.,.,.,.,.,.,.,.,.,#,.,#],
      [#,.,.,.,.,.,#,.,.,.,.,#,.,.,#,.,.,.,.,#],
      [#,.,.,.,.,.,#,#,.,.,.,.,#,.,.,#,#,.,.,#],
      [#,.,.,.,.,.,.,.,#,.,.,.,#,#,.,.,.,.,.,#],
      [#,.,#,.,#,.,.,.,.,.,.,.,.,.,.,.,.,.,.,#],
      [#,.,.,#,#,#,.,#,.,#,.,.,.,.,.,.,.,.,.,#],
      [#,#,.,#,#,.,.,#,.,.,.,.,.,.,.,.,#,o,.,#],
      [#,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,#],
      [#,.,#,.,.,.,.,.,.,.,#,.,.,.,.,#,.,.,.,#],
      [#,.,.,.,.,.,.,#,#,.,.,.,.,.,.,.,.,.,.,#],
      [#,.,.,.,.,.,.,#,#,.,.,#,#,.,.,.,.,.,.,#],
      [#,.,#,.,.,.,.,.,.,.,.,.,.,#,.,#,.,.,.,#],
      [#,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,.,#],
      [#,.,.,#,#,.,.,#,.,.,.,.,.,.,.,#,.,.,.,#],
      [#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#]],
     [[False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,True,False],
      [False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False,False]],
     [.,#,.,#,.,.,.,.,.,.,#,.,.,.,.,#,#,.,.,#,.,.,.,.,.,#,.,.,.,.,.,#,.,.,.,.,.,.,#,#,#,.,#,.,.,#,#,.,#,#,.,.,.,.,#,#,.,.,.,#,.,#,.,.,.,#,.,#,#,.,#,.,#,.,.,.,.,.,.,#,.,#,.,.,#,#,.,#,.,.,.,.,o,#,.,.,.,#])
</pre></div></div><div class="top"><p class="src"><a id="v:fixMaze" class="def">fixMaze</a> <a href="#v:fixMaze" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (Int, Int)</td><td class="doc"><p>Width and height of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Index of current corridor (base 1)</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The original maze without structures</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The resulting maze with structures</p></td></tr></table></div><div class="doc"><p>Given a maze surrounded by walls without any structures, returns the given maze with the ghost house and tunnel inserted</p><p>It iterates through each corridor, and based on the index of the current corridor, selects the appropriate structure to add</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fixMaze (20, 7) 1 (generateStartingMaze 20 7)
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[[#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#],
</code></strong>     [#,#,#,#,#, , , , , , , , , , ,#,#,#,#,#],
     [#,#,#,#,#, ,#,#,#, , ,#,#,#, ,#,#,#,#,#],
     [ ,.,.,.,., ,#, , , , , , ,#, ,.,.,.,., ],
     [#,#,#,#,#, ,#,#,#,#,#,#,#,#, ,#,#,#,#,#],
     [#,#,#,#,#, , , , , , , , , , ,#,#,#,#,#],
     [#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#]]
</pre></div></div><div class="top"><p class="src"><a id="v:generateMaze" class="def">generateMaze</a> <a href="#v:generateMaze" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Width of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Height of the maze</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>The seed used to generate random numbers</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>The resulting maze</p></td></tr></table></div><div class="doc"><p>Generates a maze of the given size based on the given seed</p><p>It works by first generating a maze surrounded by walls without any structures by calling <code><a href="Tarefa1.html#v:dfs" title="Tarefa1">dfs</a></code> and then by adding the ghost house and tunnel by calling <code><a href="Tarefa1.html#v:fixMaze" title="Tarefa1">fixMaze</a></code></p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>generateMaze 15 15 342
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>[[#,#,#,#,#,#,#,#,#,#,#,#,#,#,#],
</code></strong>     [#,.,.,.,.,.,.,.,#,#,.,.,.,.,#],
     [#,.,.,#,.,.,#,.,.,.,.,.,#,.,#],
     [#,.,#,#,.,.,.,.,.,.,#,.,.,.,#],
     [#,.,.,.,.,.,.,.,.,.,.,.,.,.,#],
     [#,., , , , , , , , , , , ,.,#],
     [#,#, ,#,#,#, , , ,#,#,#, ,.,#],
     [ ,., ,#, , , , , , , ,#, ,., ],
     [#,., ,#,#,#,#,#,#,#,#,#, ,.,#],
     [#,., , , , , , , , , , , ,#,#],
     [#,.,.,.,.,.,.,.,.,.,.,.,.,.,#],
     [#,#,.,.,.,.,.,.,.,.,.,#,.,.,#],
     [#,.,.,.,.,.,.,.,#,#,.,.,.,.,#],
     [#,.,.,.,#,.,.,.,.,.,.,.,.,.,#],
     [#,#,#,#,#,#,#,#,#,#,#,#,#,#,#]]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>