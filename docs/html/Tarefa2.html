<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa2</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module responsible for implementing the game logic.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:halfSpeed">halfSpeed</a> :: Double</li><li class="src short"><a href="#v:regularSpeed">regularSpeed</a> :: Double</li><li class="src short"><a href="#v:ghostSpawnChecks">ghostSpawnChecks</a> :: [<a href="Types.html#t:Coords" title="Types">Coords</a>]</li><li class="src short"><a href="#v:getGhostSpawnCoords">getGhostSpawnCoords</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:getPacmanSpawnCoords">getPacmanSpawnCoords</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:scareGhosts">scareGhosts</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:respawnPlayers">respawnPlayers</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:pseudoMove">pseudoMove</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:areAdjacent">areAdjacent</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool</li><li class="src short"><a href="#v:move">move</a> :: Int -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:interactPacman">interactPacman</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:interaction">interaction</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:play">play</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:halfSpeed" class="def">halfSpeed</a> :: Double <a href="#v:halfSpeed" class="selflink">#</a></p><div class="doc"><p>The speed of ghost in Dead Mode (0.5)</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>halfSpeed
</code></strong>0.5
</pre></div></div><div class="top"><p class="src"><a id="v:regularSpeed" class="def">regularSpeed</a> :: Double <a href="#v:regularSpeed" class="selflink">#</a></p><div class="doc"><p>The speed of ghost in Alive Mode (1.0)</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>regularSpeed
</code></strong>1.0
</pre></div></div><div class="top"><p class="src"><a id="v:ghostSpawnChecks" class="def">ghostSpawnChecks</a> :: [<a href="Types.html#t:Coords" title="Types">Coords</a>] <a href="#v:ghostSpawnChecks" class="selflink">#</a></p><div class="doc"><p>The places to check to spawn the ghosts, in relative position.
   (0,0) corresponds to the center of the ghost house, rounding to the left</p></div></div><div class="top"><p class="src"><a id="v:getGhostSpawnCoords" class="def">getGhostSpawnCoords</a> <a href="#v:getGhostSpawnCoords" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The given state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The coordinates of the next spawn position for a ghost</p></td></tr></table></div><div class="doc"><p>Returns the spawning position of the ghosts.
   This corresponds to the inside of the ghost house, from the center to the borders
   when the previous position is already taken, rounding to the left
   in case the width of the house is even</p><p>If there is no space available to spawn pacman, an error is thrown</p></div></div><div class="top"><p class="src"><a id="v:getPacmanSpawnCoords" class="def">getPacmanSpawnCoords</a> <a href="#v:getPacmanSpawnCoords" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The given state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The coordinates of pacman's spawn position</p></td></tr></table></div><div class="doc"><p>Returns pacman's spawning position.    
   This corresponds to the position directly below the ghost house,
   rounding to the left in case the width of the house is even</p><p>If there is no space available to spawn pacman, an error is thrown</p></div></div><div class="top"><p class="src"><a id="v:scareGhosts" class="def">scareGhosts</a> <a href="#v:scareGhosts" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The original state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The resulting state</p></td></tr></table></div><div class="doc"><p>Changes the state of ghosts to Dead and reduces their speed to half</p><p>This function is called whenever pacman eats a food big</p><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>scareGhosts state
</code></strong>State {maze = [[#,#,#,#,#,#,#,#],[ ,*,.,.,.,M,W, ],[ ,.,.,&lt;,.,#,., ],[#,#,#,#,#,#,#,#]], playersState = [Pacman (PacState {pacState = (0,(3,2),1.0,R,5,1),
timeMega = 0.0, openClosed = Open, pacmanMode = Normal}),Ghost (GhoState {ghostState = (1,(6,1),0.5,L,10,0), ghostMode = Dead})], level = 1}
</pre></div></div><div class="top"><p class="src"><a id="v:respawnPlayers" class="def">respawnPlayers</a> <a href="#v:respawnPlayers" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The original game state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The updated game state, with the players at their spawning positions</p></td></tr></table></div><div class="doc"><p>Resets the game state.</p><p>More specifically, it removes the players from their locations and places them at their spawning positions.
   It also revives dead ghosts and set pacman's time mega to 0.</p><p>This function is called when pacman loses a life and the game is reset.</p></div></div><div class="top"><p class="src"><a id="v:pseudoMove" class="def">pseudoMove</a> <a href="#v:pseudoMove" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The (y, x) size of the maze (used for the tunnel)</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a></td><td class="doc"><p>The direction to move in</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The initial position of the player</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The coordinates of the square the player lands in</p></td></tr></table></div><div class="doc"><p>When combined with areAdjacent, defines the geometry of the board
   (currently the coordinates are mod n). Returns the coordinates of
   where a player lands should he move in the specified
   direction (Move does not have to be legal)</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>pseudoMove (2,3) L
</code></strong>(2,2)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>pseudoMove (2,3) D
</code></strong>(3,3)
</pre></div></div><div class="top"><p class="src"><a id="v:areAdjacent" class="def">areAdjacent</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool <a href="#v:areAdjacent" class="selflink">#</a></p><div class="doc"><p>When combined with pseudoMove, defines the geometry of the board
   (currently the coordinates are mod n). Returns whether
   two given cells of the maze are adjacent</p><h2><em>Examples</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>areAdjacent testMaze (2,3) (3,3)
</code></strong>True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>areAdjacent testMaze (2,2) (3,3)
</code></strong>False
</pre></div></div><div class="top"><p class="src"><a id="v:move" class="def">move</a> <a href="#v:move" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>The id of the player who will move</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></td><td class="doc"><p>The new coordinates</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The current state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The resulting state</p></td></tr></table></div><div class="doc"><p>This function moves pacman to the coords, sets his new position as Empty
   and calculates the resulting effects on the state:</p><ul><li>If he walks into Empty, nothing happens</li><li>If he walks into a Food Little, he gains 1 point</li><li>If he walks into a Food Big, his mode becomes Mega, he gains 5 points and all ghosts
     become scared (their state becomes Dead and their speed is reduced to half)</li></ul><p>If called by a non-pacman player, an error may be thrown</p></div></div><div class="top"><p class="src"><a id="v:interactPacman" class="def">interactPacman</a> <a href="#v:interactPacman" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="Types.html#t:Player" title="Types">Player</a>]</td><td class="doc"><p>the list of players to interact with the main player</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>the original state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>the resulting state</p></td></tr></table></div><div class="doc"><p>Computes the interaction player by player.
   This function is an auxiliar function to interation.
   If for some reason it is called by a non-Pacman player, an error may be thrown</p></div></div><div class="top"><p class="src"><a id="v:interaction" class="def">interaction</a> <a href="#v:interaction" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>the original state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>the resulting state</p></td></tr></table></div><div class="doc"><p>Calculates the result from the player interactions.
   These interactions happen when two players are at the same position:</p><ul><li>A dead ghost is killed by pacman, which sends him back to the ghost house alive and
     causes pacman to gain 10 points</li><li>An alive ghost kills pacman, which resets the level and causes pacman to lose 1 life</li><li>If pacman had 0 lives when he interacts with an alive ghost, instead his state changes to Dying
     and all of the ghosts are removed from the game</li></ul><p>Aditionally, if pacman runs out of timeMega, his state goes back to Normal and the ghosts' state to Alive.
   If called by a ghost, an error may be thrown</p></div></div><div class="top"><p class="src"><a id="v:play" class="def">play</a> <a href="#v:play" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Types.html#t:Play" title="Types">Play</a></td><td class="doc"><p>The specified play</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The original game state</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:State" title="Types">State</a></td><td class="doc"><p>The resulting game state</p></td></tr></table></div><div class="doc"><p>Updates the game state according to the specified play:</p><ul><li>If the player (assumed to be a pacman) is Dying, nothing happens</li><li>If the player tries to move in a diferent direction than his orientation, instead of
     moving he is rotated to the direction he tried to move towards</li><li>If the player should move (there is no Wall in front of him),
     this function calls move and then interaction</li></ul><h2><em>Example</em></h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>play (Move 0 L) state
</code></strong>State {maze = [[#,#,#,#,#,#,#,#],[ ,*,.,.,.,M,., ],[ ,.,.,&gt;,.,#,., ],[#,#,#,#,#,#,#,#]], playersState = [Pacman (PacState {pacState = (0,(3,2),1.0,L,5,1),
timeMega = 0.0, openClosed = Open, pacmanMode = Normal}),Ghost (GhoState {ghostState = (1,(6,1),1.0,L,10,0), ghostMode = Alive})], level = 1}
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>